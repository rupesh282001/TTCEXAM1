<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Secure Descriptive Exam</title>

<!-- Browser Tab Icon -->
<link rel="icon" type="image/png" href="image.png">

<script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-slate-100 h-screen overflow-hidden flex items-center justify-center">

<div class="bg-white shadow-2xl rounded-xl w-full max-w-xl p-6 max-h-[90vh] overflow-hidden">

  <!-- LOGIN -->
  <div id="login">

    <!-- ðŸ”¹ HEADER IMAGE -->
    <div class="flex justify-center mb-4">
      <img
        src="THECOS_Google_Form_Header.png"
        alt="THECOS Header"
        class="max-h-24 object-contain"
      />
    </div>

    <h1 class="text-2xl font-bold text-center mb-4">Online Exam</h1>

    <input id="studentName" type="text" placeholder="Enter Full Name"
      class="w-full border rounded p-2 mb-3">

    <input id="studentEmail" type="email" placeholder="Enter Email Address"
      class="w-full border rounded p-2 mb-4">

    <button onclick="startExam()"
      class="w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700">
      Start Exam
    </button>
  </div>

  <!-- EXAM -->
  <div id="exam" class="hidden h-full flex flex-col">

    <!-- HEADER -->
    <div class="flex justify-between items-center mb-3">
      <span id="timer" class="text-red-600 font-bold text-lg"></span>
      <span class="text-sm text-gray-500">
        Copy / Paste / Tab switch disabled
      </span>
    </div>

    <!-- SCROLLABLE CONTENT -->
    <div id="scrollArea" class="flex-1 overflow-y-auto pr-2">

      <h2 id="question" class="font-semibold text-lg mb-3"></h2>

      <textarea id="answer"
        class="w-full border rounded p-3 h-60 mb-4 resize-none"
        placeholder="Type your answer here..."
        onpaste="return false"
        oncopy="return false"
        oncut="return false"></textarea>

    </div>

    <!-- FOOTER -->
    <div class="pt-3 border-t">
      <button onclick="nextQuestion()"
        class="bg-green-600 text-white px-5 py-2 rounded hover:bg-green-700">
        Next
      </button>
    </div>

  </div>

</div>

<script>
/* ================= CONFIG ================= */
const QUESTIONS =[
  "What is a Co-operative Society? Explain its main objectives.",
  "Write the principles of Co-operation.",
  "What is a Credit Co-operative Society? Explain its functions.",
  "Explain the organizational structure of a Co-operative Society.",
  "Write the difference between a Company and a Co-operative Society.",
  "Explain the importance of audit in Co-operative Societies.",
  "What is the role of the General Body in a Co-operative Society?",
  "Write the sources of funds of a Co-operative Society.",
  "What are the advantages of a Co-operative Credit Society compared to a bank?",
  "How do financial statements help in monitoring credit risk?",
  "Explain the role of communication in improving customer relations.",
  "How does employee attitude affect organizational performance? How can it be improved?",
  "Misunderstanding among staff leads to delays in services of a financial institution. How can it be overcome?",
  "A Co-operative Society faces liquidity problems due to poor planning of deposits and loans. How can effective planning help?",
  "An organisation suffers losses due to untrained staff handling accounts. How can effective staffing prevent this?",
  "Employees are demotivated due to weak leadership. How can effective leadership improve performance?",
  "Customers complain about lack of information regarding loan schemes. How can communication solve this?",
  "Managing Committee faces difficulty in approving loans due to conflicting opinions. How can scientific decision-making help?",
  "Delays in loan processing cause dissatisfaction. How can time management improve service delivery?",
  "A Co-operative Society is losing members to commercial banks. How can marketing help regain members?",
  "Uniform loan schemes result in poor utilisation. How can market segmentation improve effectiveness?",
  "Deposit schemes are unattractive. How can service planning improve deposit mobilisation?",
  "High interest rates reduce borrowings. How can proper pricing improve loan demand?",
  "Customers from remote areas face access difficulties. How can service delivery improve marketing?",
  "Customer loyalty is declining. How can relationship marketing strengthen loyalty?",
  "Private banks attract youth with digital services. How can a Credit Co-operative attract young members?",
  "Institution has surplus funds but low loan demand. Suggest a marketing strategy.",
  "Low staff morale causes poor service. How can morale and performance be improved?",
  "Loan recovery staff miss targets due to low motivation. How can management motivate them?",
  "Non-Performing Assets (NPA) are high. What steps should be taken?",
  "Delays in loan processing cause dissatisfaction. How can time management help?",
  "Employees feel management decisions are biased. How does perception influence behaviour?",
  "Loan recovery staff experience stress. How does stress affect behaviour and how can it be managed?",
  "How does the Balance Sheet help assess the financial position of a society?",
  "Balance Sheet shows high outstanding loans and overdues. How should management interpret this?",
  "How can proper pricing improve demand for loans?",
  "How can proper maintenance of books of accounts solve problems?",
  "How can motivation improve employee morale and performance?",
  "How will you handle confidential information?",
  "How does stress influence human behaviour and how can it be managed?",
  "How can scientific decision-making help management?",
  "What are the powers and duties of an Assistant Secretary in a Co-operative Society?",
  "How does employee attitude affect organizational performance?",
  "How can management motivate employees?",
  "How does control help prevent mismanagement?",
  "Cash has been stolen from a cash box. What steps should be taken?",
  "How does proper organising improve efficiency?",
  "Describe a situation where unforeseen circumstances affected your punctuality. How did you handle it?",
  "Describe a time you managed multiple tasks and meetings in a day. What strategies did you use?",
  "If the Assistant Secretary post is not given to you, how will it affect the organisation?"
];

const QUESTION_VISIBLE_TIME = 10; // seconds
const ANSWER_TIME = 120;          // seconds
/* ========================================= */

let studentName = "";
let studentEmail = "";
let answers = [];
let index = 0;

let answerTimeLeft;
let answerTimer;
let questionTimer;

let examFinished = false;

/* START EXAM */
function startExam() {
  studentName = document.getElementById("studentName").value.trim();
  studentEmail = document.getElementById("studentEmail").value.trim();

  if (!studentName || !studentEmail) {
    return alert("Enter name and email address");
  }

  resetState();
  document.getElementById("login").classList.add("hidden");
  document.getElementById("exam").classList.remove("hidden");

  if (document.documentElement.requestFullscreen) {
    document.documentElement.requestFullscreen();
  }

  loadQuestion();
}

/* RESET */
function resetState() {
  answers = [];
  index = 0;
  examFinished = false;
}

/* LOAD QUESTION */
function loadQuestion() {
  document.getElementById("question").innerText = QUESTIONS[index];
  document.getElementById("answer").value = "";
  document.getElementById("scrollArea").scrollTop = 0;

  answerTimeLeft = ANSWER_TIME;
  updateTimer();

  clearTimeout(questionTimer);
  clearInterval(answerTimer);

  questionTimer = setTimeout(() => {
    document.getElementById("question").innerText = "";
  }, QUESTION_VISIBLE_TIME * 1000);

  answerTimer = setInterval(() => {
    answerTimeLeft--;
    updateTimer();
    if (answerTimeLeft <= 0) nextQuestion();
  }, 1000);
}

/* TIMER */
function updateTimer() {
  document.getElementById("timer").innerText =
    `Answer time left: ${answerTimeLeft}s`;
}

/* NEXT QUESTION */
function nextQuestion() {
  if (examFinished) return;

  clearTimeout(questionTimer);
  clearInterval(answerTimer);

  answers.push(document.getElementById("answer").value);
  index++;

  if (index < QUESTIONS.length) {
    loadQuestion();
  } else {
    normalFinish();
  }
}

/* NORMAL FINISH */
function normalFinish() {
  examFinished = true;

  clearTimeout(questionTimer);
  clearInterval(answerTimer);

  exitFullscreen();
  sendAnswersByEmail();

  alert("Exam completed. Please send the email to submit your answers.");
  goToLogin();
}

/* VIOLATION */
function violationFinish(reason) {
  if (examFinished) return;
  examFinished = true;

  clearTimeout(questionTimer);
  clearInterval(answerTimer);

  exitFullscreen();
  alert(reason + "\nExam terminated.");
  goToLogin();
}

/* GO BACK */
function goToLogin() {
  document.getElementById("exam").classList.add("hidden");
  document.getElementById("login").classList.remove("hidden");
}

/* EMAIL */
function sendAnswersByEmail() {
  let body =
    `Student Name: ${studentName}\n` +
    `Student Email: ${studentEmail}\n\n`;

  QUESTIONS.forEach((q, i) => {
    body += `Question ${i + 1}:\n${q}\n\n`;
    body += `Answer:\n${answers[i] || "No answer"}\n`;
    body += `------------------------------\n\n`;
  });

  const subject = encodeURIComponent(`Exam Submission â€” ${studentName}`);
  const emailBody = encodeURIComponent(body);

  window.location.href =
    `mailto:surirupesh2001@gmail.com?subject=${subject}&body=${emailBody}`;
}

/* TAB SWITCH */
document.addEventListener("visibilitychange", () => {
  if (document.hidden && !examFinished) {
    violationFinish("Tab switching detected");
  }
});

/* BLOCK COPY / PASTE */
document.addEventListener("keydown", (e) => {
  if (
    (e.ctrlKey || e.metaKey) &&
    (e.key.toLowerCase() === "c" || e.key.toLowerCase() === "v")
  ) {
    e.preventDefault();
    alert("Copy / Paste is not allowed");
  }
});

/* DISABLE RIGHT CLICK */
document.addEventListener("contextmenu", e => e.preventDefault());

/* PAGE EXIT BLOCK */
window.onbeforeunload = () => {
  if (!examFinished) return "Exam in progress";
};

/* EXIT FULLSCREEN */
function exitFullscreen() {
  if (document.fullscreenElement) {
    document.exitFullscreen();
  }
}
</script>

</body>
</html>
